(function(t){function e(e){for(var o,a,s=e[0],l=e[1],c=e[2],d=0,p=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&p.push(n[a][0]),n[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(p.length)p.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],o=!0,s=1;s<i.length;s++){var l=i[s];0!==n[l]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=i[0]))}return t}var o={},n={upload:0},r=[];function a(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=o,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(i,o,function(e){return t[e]}.bind(null,o));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;r.push([12,"chunk-vendors","chunk-common"]),i()})({12:function(t,e,i){t.exports=i("71b6")},"5d14":function(t,e,i){},"71b6":function(t,e,i){"use strict";i.r(e);var o=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"v"}},[i("v-header",{attrs:{location:"/upload"},on:{logged:t.logged}}),i("message-box"),i("main",[i("h2",[t._v("Upload")]),i("v-form")],1),i("v-footer")],1)},r=[],a=i("71c2"),s=i("f771"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[i("div",[i("file-input",{attrs:{accept:"image/*",file:t.file,required:""},on:{"update:file":function(e){t.file=e}}}),i("input",{staticClass:"action",attrs:{type:"button",value:"Choose a photo"},on:{click:t.chooseFile}}),i("span",[t._v(t._s(t.alt))])],1),void 0!==t.file?i("div",[i("img",{attrs:{src:t.src,alt:t.alt}}),i("hr"),i("div",{staticClass:"info"},[i("label",[i("span",[t._v("Title")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text",required:""},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),i("label",[i("span",[t._v("Description")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],attrs:{required:""},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}})]),i("contents-input",{attrs:{contents:t.contents},on:{"update:contents":function(e){t.contents=e}}}),i("visibility-select",{attrs:{visibility:t.visibility},on:{"update:visibility":function(e){t.visibility=e}}}),i("location-select",{attrs:{country:t.country,city:t.city},on:{"update:country":function(e){t.country=e},"update:city":function(e){t.city=e}}}),i("confirm-box",{attrs:{show:t.showConfirm,result:t.confirmResult,"default-result":""},on:{"update:show":function(e){t.showConfirm=e},"update:result":function(e){t.confirmResult=e}}},[t._v("Are you sure you want to upload the photo?")]),t.showConfirm?t._e():i("input",{staticClass:"action",attrs:{type:"submit",value:"Upload"}})],1)]):t._e()])},c=[],u=i("1157"),d=i.n(u),p=i("2ef0"),f=i.n(p),v=i("f37b"),h=i("ad46"),m=i("e385"),y=i("9c6f"),b=i("89f5");let g=f.a.once(()=>d()("#message-box")[0].__vue__);var w={name:"v-form",components:{FileInput:v["a"],ContentsInput:h["a"],VisibilitySelect:m["a"],LocationSelect:y["a"],ConfirmBox:b["a"]},data:function(){return{file:void 0,src:void 0,alt:void 0,title:"",description:"",contents:[],visibility:void 0,country:void 0,city:void 0,showConfirm:!1,confirmResult:void 0}},methods:{submit(){this.showConfirm=!0},chooseFile(t){d()(t.target).prev().click()}},watch:{file(){if(void 0===this.file)this.alt=void 0;else{let t=new FileReader;t.readAsDataURL(this.file),t.onload=()=>{this.src=t.result,this.alt=this.file.name}}},confirmResult(){let t=()=>{this.confirmResult=!1,g().message="Unauthorized operation. You may try uploading again or refreshing the page",location.replace("#")};!0===this.confirmResult&&d.a.ajax({method:"POST",url:syt.backend+"/upload",xhrFields:{withCredentials:!0},data:{file:this.file.name,title:this.title,description:this.description,contents:this.contents,visibility:this.visibility,city:this.city},dataType:"text",success:e=>{switch(e){case"ok":let e=new FileReader;e.readAsArrayBuffer(this.file),e.onload=()=>{d.a.ajax({method:"POST",url:syt.backend+"/upload",xhrFields:{withCredentials:!0},contentType:!1,processData:!1,data:e.result,dataType:"text",success:e=>{switch(e){case"ok":window.location="/photos";break;case"unauthorized":t();break}}})};break;case"unauthorized":t();break}}})}}},x=w,_=(i("cb79"),i("2877")),O=Object(_["a"])(x,l,c,!1,null,"756e19a7",null),k=O.exports,j=i("076e"),C={name:"v",components:{VHeader:a["a"],MessageBox:s["a"],VForm:k,VFooter:j["a"]},methods:{logged(){syt.logged||(window.location="/login")}}},P=C,F=Object(_["a"])(P,n,r,!1,null,"51ffae8e",null),R=F.exports;o["a"].config.productionTip=!1,new o["a"]({render:t=>t(R)}).$mount("#v")},cb79:function(t,e,i){"use strict";var o=i("5d14"),n=i.n(o);n.a}});
//# sourceMappingURL=upload.8c5439c8.js.map